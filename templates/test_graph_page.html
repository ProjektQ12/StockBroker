{% extends "base.html" %}

{% block title %}Test Chart: {{ company_name if company_name else ticker }}{% endblock %}

{% block content %}
    <h1>
        Test Chart für {{ company_name if company_name else ticker }}
    </h1>
     <form id="chartOptionsFormTest" method="GET" action="{{ url_for('test_graph_page') }}" style="margin-bottom:20px; display:flex; gap:10px; align-items:center; background-color:transparent; padding:0;">
        <input type="hidden" name="ticker_symbol" value="{{ticker}}"> {# Falls man den Ticker mal ändern will per URL #}
        <div>
            <label for="periodSelectTest" style="font-size:0.85em; margin-right:5px;">Zeitraum:</label>
            <select name="period" id="periodSelectTest" onchange="this.form.submit()" style="padding:6px 8px; font-size:0.9em; border-radius:4px;">
                {% for p_val, p_disp in available_periods %}
                    <option value="{{ p_val }}" {{ 'selected' if period == p_val }}>{{ p_disp }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <label for="intervalSelectTest" style="font-size:0.85em; margin-right:5px;">Intervall:</label>
            <select name="interval" id="intervalSelectTest" onchange="this.form.submit()" style="padding:6px 8px; font-size:0.9em; border-radius:4px;">
                {% for i_val, i_disp in available_intervals %}
                    <option value="{{ i_val }}" {{ 'selected' if interval == i_val }}>{{ i_disp }}</option>
                {% endfor %}
            </select>
        </div>
    </form>

    {% if error %}
         {% if "Hinweis:" in error %}
            <div class="info-box">{{ error }}</div>
        {% else %}
            <div class="error-box">{{ error }}</div>
        {% endif %}
    {% endif %}

    {% if chart_html %}
        <div class="chart-container">
            {{ chart_html | safe }}
        </div>
    {% elif not error %}
        <p>Chart konnte nicht geladen werden.</p>
    {% endif %}
    
    <a href="{{ url_for('search_stock_page') }}" class="footer-link" style="margin-top:20px;">« Zurück zur Ticker-Suche</a>
{% endblock %}